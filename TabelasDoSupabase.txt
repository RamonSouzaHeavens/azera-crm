| ?column?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| # Schema do Banco de Dados

### Tabela: `achievement_definitions`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | YES | `` |
| `key` | `text` | NO | `` |
| `name` | `text` | NO | `` |
| `description` | `text` | YES | `` |
| `icon` | `text` | NO | `''::text` |
| `category` | `text` | NO | `` |
| `metric_type` | `text` | NO | `` |
| `metric_threshold` | `integer` | NO | `1` |
| `tier` | `text` | NO | `'bronze'::text` |
| `points` | `integer` | NO | `10` |
| `is_active` | `boolean` | YES | `true` |
| `is_default` | `boolean` | YES | `false` |
| `display_order` | `integer` | YES | `0` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `api_keys`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `name` | `text` | NO | `` |
| `key` | `text` | YES | `` |
| `key_hash` | `text` | NO | `` |
| `is_active` | `boolean` | YES | `true` |
| `permissions` | `ARRAY` | YES | `ARRAY['read'::text]` |
| `expires_at` | `timestamp with time zone` | YES | `` |
| `created_by` | `uuid` | YES | `` |
| `last_used_at` | `timestamp with time zone` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `atividades`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `cliente_id` | `uuid` | NO | `` |
| `user_id` | `uuid` | YES | `` |
| `tipo` | `text` | NO | `'nota'::text` |
| `conteudo` | `text` | NO | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `audit_logs`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `user_id` | `uuid` | YES | `` |
| `action` | `text` | NO | `` |
| `entity_type` | `text` | NO | `` |
| `entity_id` | `uuid` | YES | `` |
| `details` | `jsonb` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `automacao_logs`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `automacao_id` | `uuid` | NO | `` |
| `status` | `text` | NO | `` |
| `dados_enviados` | `jsonb` | YES | `` |
| `resposta` | `jsonb` | YES | `` |
| `erro` | `text` | YES | `` |
| `codigo_http` | `integer` | YES | `` |
| `tempo_ms` | `integer` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `automacoes`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `nome` | `text` | NO | `` |
| `tipo` | `text` | NO | `` |
| `url` | `text` | NO | `` |
| `webhook_secret` | `text` | YES | `` |
| `metodo_http` | `text` | NO | `` |
| `headers` | `jsonb` | YES | `` |
| `body_template` | `text` | YES | `` |
| `entidade_alvo` | `text` | NO | `` |
| `evento` | `text` | NO | `` |
| `ativo` | `boolean` | YES | `true` |
| `tentativas_falhadas` | `integer` | YES | `0` |
| `ultimo_status` | `text` | YES | `` |
| `ultimo_erro` | `text` | YES | `` |
| `ultima_execucao` | `timestamp with time zone` | YES | `` |
| `proxima_execucao` | `timestamp with time zone` | YES | `` |
| `frequencia_minutos` | `integer` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `campanhas`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `nome` | `text` | NO | `` |
| `descricao` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |
| `ativa` | `boolean` | YES | `true` |

### Tabela: `cliente_produtos`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `cliente_id` | `uuid` | NO | `` |
| `produto_id` | `uuid` | NO | `` |
| `interesse_level` | `text` | YES | `` |
| `notas` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `clientes`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `nome` | `text` | NO | `` |
| `email` | `text` | YES | `` |
| `telefone` | `text` | YES | `` |
| `notas` | `text` | YES | `` |
| `status` | `text` | YES | `'lead'::text` |
| `valor_potencial` | `numeric` | YES | `` |
| `campanha_id` | `uuid` | YES | `` |
| `origem_id` | `uuid` | YES | `` |
| `motivo_perda_id` | `uuid` | YES | `` |
| `compartilhado_equipe` | `boolean` | YES | `false` |
| `proprietario_id` | `uuid` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |
| `avatar_url` | `text` | YES | `` |
| `categoria` | `text` | YES | `'trabalho'::text` |

### Tabela: `company_settings`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `tenant_id` | `uuid` | NO | `` |
| `nome_fantasia` | `text` | YES | `` |
| `cnpj` | `text` | YES | `` |
| `telefone` | `text` | YES | `` |
| `email` | `text` | YES | `` |
| `endereco` | `text` | YES | `` |
| `cep` | `text` | YES | `` |
| `cidade` | `text` | YES | `` |
| `estado` | `text` | YES | `` |
| `pais` | `text` | YES | `'Brasil'::text` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `contacts`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `nome` | `text` | NO | `` |
| `email` | `text` | YES | `` |
| `telefone` | `text` | YES | `` |
| `empresa` | `text` | YES | `` |
| `cargo` | `text` | YES | `` |
| `notas` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `conversations`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `contact_id` | `uuid` | YES | `` |
| `channel` | `text` | NO | `` |
| `last_message_content` | `text` | YES | `` |
| `last_message_at` | `timestamp with time zone` | YES | `now()` |
| `unread_count` | `integer` | NO | `0` |
| `total_messages` | `integer` | NO | `0` |
| `status` | `text` | NO | `'open'::text` |
| `assigned_to` | `uuid` | YES | `` |
| `assigned_at` | `timestamp with time zone` | YES | `` |
| `tags` | `ARRAY` | YES | `'{}'::text[]` |
| `created_at` | `timestamp with time zone` | NO | `now()` |
| `updated_at` | `timestamp with time zone` | NO | `now()` |
| `avatar_url` | `text` | YES | `` |

### Tabela: `despesas`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `descricao` | `text` | NO | `` |
| `valor` | `numeric` | NO | `` |
| `tipo` | `USER-DEFINED` | NO | `'variavel'::despesa_tipo` |
| `categoria` | `USER-DEFINED` | NO | `` |
| `status` | `USER-DEFINED` | NO | `'ativa'::despesa_status` |
| `ativa` | `boolean` | YES | `true` |
| `data_vencimento` | `timestamp with time zone` | YES | `` |
| `data_pagamento` | `timestamp with time zone` | YES | `` |
| `data_inicio` | `timestamp with time zone` | YES | `now()` |
| `data_fim` | `timestamp with time zone` | YES | `` |
| `frequencia` | `text` | YES | `` |
| `responsavel_id` | `uuid` | YES | `` |
| `notas` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `equipes`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `nome` | `text` | NO | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `gamification_stats`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `user_id` | `uuid` | NO | `` |
| `tenant_id` | `uuid` | NO | `` |
| `xp` | `integer` | YES | `0` |
| `level` | `integer` | YES | `1` |
| `current_streak` | `integer` | YES | `0` |
| `last_activity` | `timestamp with time zone` | YES | `now()` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `integrations`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `channel` | `text` | NO | `` |
| `provider` | `text` | NO | `` |
| `status` | `text` | NO | `'inactive'::text` |
| `is_active` | `boolean` | YES | `true` |
| `credentials` | `jsonb` | NO | `'{}'::jsonb` |
| `config` | `jsonb` | YES | `'{}'::jsonb` |
| `last_connected_at` | `timestamp with time zone` | YES | `` |
| `error_message` | `text` | YES | `` |
| `created_by` | `uuid` | YES | `` |
| `created_at` | `timestamp with time zone` | NO | `now()` |
| `updated_at` | `timestamp with time zone` | NO | `now()` |

### Tabela: `lead_attachments`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `lead_id` | `uuid` | NO | `` |
| `file_name` | `text` | NO | `` |
| `file_url` | `text` | NO | `` |
| `file_type` | `text` | YES | `` |
| `file_size` | `integer` | YES | `` |
| `uploaded_by` | `uuid` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `lead_custom_field_values`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `lead_id` | `uuid` | NO | `` |
| `custom_field_id` | `uuid` | NO | `` |
| `value` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `lead_custom_fields`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `field_name` | `text` | NO | `` |
| `field_type` | `text` | NO | `` |
| `options` | `jsonb` | YES | `` |
| `required` | `boolean` | YES | `false` |
| `active` | `boolean` | YES | `true` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `lead_loss_reasons`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `category` | `text` | NO | `` |
| `reason` | `text` | NO | `` |
| `is_active` | `boolean` | YES | `true` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `lead_origins`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `name` | `text` | NO | `` |
| `type` | `text` | YES | `'manual'::text` |
| `description` | `text` | YES | `` |
| `is_active` | `boolean` | YES | `true` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `lead_tasks`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `lead_id` | `uuid` | NO | `` |
| `title` | `text` | NO | `` |
| `description` | `text` | YES | `` |
| `due_date` | `timestamp with time zone` | YES | `` |
| `completed` | `boolean` | YES | `false` |
| `assigned_to` | `uuid` | YES | `` |
| `created_by` | `uuid` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `lead_timeline`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `lead_id` | `uuid` | NO | `` |
| `event_type` | `text` | NO | `` |
| `event_data` | `jsonb` | YES | `` |
| `user_id` | `uuid` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `memberships`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `user_id` | `uuid` | NO | `` |
| `role` | `text` | NO | `'vendedor'::text` |
| `active` | `boolean` | YES | `true` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |
| `receive_meta_leads` | `boolean` | YES | `true` |
| `last_meta_lead_received_at` | `timestamp with time zone` | YES | `` |

### Tabela: `messages`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `conversation_id` | `uuid` | NO | `` |
| `direction` | `text` | NO | `` |
| `message_type` | `text` | NO | `'text'::text` |
| `content` | `text` | YES | `` |
| `media_url` | `text` | YES | `` |
| `media_mime_type` | `text` | YES | `` |
| `media_size_bytes` | `bigint` | YES | `` |
| `location_latitude` | `numeric` | YES | `` |
| `location_longitude` | `numeric` | YES | `` |
| `location_name` | `text` | YES | `` |
| `status` | `text` | NO | `'pending'::text` |
| `external_message_id` | `text` | YES | `` |
| `replied_to_message_id` | `uuid` | YES | `` |
| `sender_id` | `text` | YES | `` |
| `sent_at` | `timestamp with time zone` | YES | `` |
| `delivered_at` | `timestamp with time zone` | YES | `` |
| `read_at` | `timestamp with time zone` | YES | `` |
| `failed_at` | `timestamp with time zone` | YES | `` |
| `error_message` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | NO | `now()` |
| `updated_at` | `timestamp with time zone` | NO | `now()` |

### Tabela: `pipeline_stages`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `key` | `text` | NO | `` |
| `label` | `text` | NO | `` |
| `color` | `text` | NO | `'#6B7280'::text` |
| `order` | `integer` | YES | `0` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `plans`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | YES | `` |
| `name` | `text` | NO | `` |
| `description` | `text` | YES | `` |
| `price_cents` | `integer` | YES | `` |
| `billing_period` | `text` | YES | `` |
| `provider_price_id` | `text` | YES | `` |
| `stripe_price_id_mensal` | `text` | YES | `` |
| `stripe_price_id_semestral` | `text` | YES | `` |
| `stripe_price_id_anual` | `text` | YES | `` |
| `features` | `jsonb` | YES | `'[]'::jsonb` |
| `active` | `boolean` | YES | `true` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `processes`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `title` | `text` | NO | `` |
| `description` | `text` | YES | `` |
| `status` | `text` | YES | `'active'::text` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `product_custom_field_values`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `produto_id` | `uuid` | NO | `` |
| `custom_field_id` | `uuid` | NO | `` |
| `value_text` | `text` | YES | `` |
| `value_number` | `numeric` | YES | `` |
| `value_boolean` | `boolean` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `product_custom_fields`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `field_name` | `text` | NO | `` |
| `field_type` | `text` | NO | `` |
| `options` | `jsonb` | YES | `` |
| `required` | `boolean` | YES | `false` |
| `active` | `boolean` | YES | `true` |
| `searchable` | `boolean` | YES | `false` |
| `show_in_list` | `boolean` | YES | `false` |
| `show_in_filters` | `boolean` | YES | `false` |
| `display_order` | `integer` | YES | `0` |
| `min_value` | `numeric` | YES | `` |
| `max_value` | `numeric` | YES | `` |
| `min_length` | `integer` | YES | `` |
| `max_length` | `integer` | YES | `` |
| `pattern` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `produtos`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `nome` | `text` | NO | `` |
| `descricao` | `text` | YES | `` |
| `categoria` | `text` | YES | `` |
| `codigo_referencia` | `text` | YES | `` |
| `valor` | `numeric` | YES | `` |
| `quantidade_estoque` | `numeric` | YES | `` |
| `capa_url` | `text` | YES | `` |
| `status` | `text` | YES | `'disponivel'::text` |
| `destaque` | `boolean` | YES | `false` |
| `filtros` | `jsonb` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |
| `galeria` | `jsonb` | YES | `'[]'::jsonb` |
| `anexos` | `jsonb` | YES | `'[]'::jsonb` |
| `ativo` | `boolean` | YES | `true` |

### Tabela: `produtos_equipe`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `nome` | `character varying` | NO | `` |
| `descricao` | `text` | YES | `` |
| `tipo` | `character varying` | YES | `` |
| `valor` | `numeric` | YES | `` |
| `capa_url` | `text` | YES | `` |
| `status` | `character varying` | YES | `'disponivel'::character varying` |
| `destaque` | `boolean` | YES | `false` |
| `criado_por` | `uuid` | NO | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `profiles`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `` |
| `display_name` | `text` | YES | `` |
| `full_name` | `text` | YES | `` |
| `phone` | `text` | YES | `` |
| `bio` | `text` | YES | `` |
| `avatar_url` | `text` | YES | `` |
| `default_tenant_id` | `uuid` | YES | `` |
| `disabled` | `boolean` | YES | `false` |
| `profile_completed` | `boolean` | YES | `false` |
| `onboarding_completed` | `boolean` | YES | `false` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `proposals`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `user_id` | `uuid` | NO | `` |
| `client_name` | `text` | NO | `` |
| `value` | `numeric` | NO | `` |
| `status` | `text` | NO | `'pending'::text` |
| `template_id` | `text` | NO | `` |
| `file_url` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | NO | `now()` |
| `updated_at` | `timestamp with time zone` | NO | `now()` |

### Tabela: `sales_playbook_objections`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `user_id` | `uuid` | NO | `` |
| `team_id` | `uuid` | YES | `` |
| `objection` | `text` | NO | `` |
| `response` | `text` | NO | `` |
| `tactic` | `text` | NO | `` |
| `stage` | `text` | NO | `` |
| `is_default` | `boolean` | NO | `false` |
| `created_at` | `timestamp with time zone` | NO | `now()` |
| `updated_at` | `timestamp with time zone` | NO | `now()` |

### Tabela: `subscriptions`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `user_id` | `uuid` | NO | `` |
| `tenant_id` | `uuid` | YES | `` |
| `plan_id` | `uuid` | YES | `` |
| `stripe_customer_id` | `text` | YES | `` |
| `stripe_subscription_id` | `text` | YES | `` |
| `stripe_price_id` | `text` | YES | `` |
| `status` | `text` | YES | `'incomplete'::text` |
| `current_period_start` | `timestamp with time zone` | YES | `` |
| `current_period_end` | `timestamp with time zone` | YES | `` |
| `trial_start` | `timestamp with time zone` | YES | `` |
| `trial_end` | `timestamp with time zone` | YES | `` |
| `cancel_at` | `timestamp with time zone` | YES | `` |
| `canceled_at` | `timestamp with time zone` | YES | `` |
| `ended_at` | `timestamp with time zone` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |
| `provider` | `text` | YES | `'stripe'::text` |

### Tabela: `tarefa_anexos`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `tarefa_id` | `uuid` | NO | `` |
| `file_name` | `text` | NO | `` |
| `file_url` | `text` | NO | `` |
| `file_type` | `text` | YES | `` |
| `file_size` | `integer` | YES | `` |
| `uploaded_by` | `uuid` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `tarefa_checklist`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tarefa_id` | `uuid` | NO | `` |
| `texto` | `text` | NO | `` |
| `done` | `boolean` | YES | `false` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `tarefas`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `titulo` | `text` | NO | `` |
| `descricao` | `text` | YES | `` |
| `status` | `text` | YES | `'pendente'::text` |
| `prioridade` | `text` | YES | `'media'::text` |
| `cliente_id` | `uuid` | YES | `` |
| `produto_id` | `uuid` | YES | `` |
| `responsavel_id` | `uuid` | YES | `` |
| `responsavel_nome` | `text` | YES | `` |
| `equipe_id` | `uuid` | YES | `` |
| `process_id` | `uuid` | YES | `` |
| `data_vencimento` | `timestamp with time zone` | YES | `` |
| `tempo_gasto_minutos` | `integer` | YES | `0` |
| `estimativa_minutos` | `integer` | YES | `` |
| `checklist` | `jsonb` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `tarefas_produtos`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tarefa_id` | `uuid` | NO | `` |
| `produto_id` | `uuid` | NO | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `task_stages`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `key` | `text` | NO | `` |
| `label` | `text` | NO | `` |
| `color` | `text` | NO | `'#6B7280'::text` |
| `order` | `integer` | YES | `0` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `team_invites`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `email` | `text` | NO | `` |
| `role` | `text` | NO | `'vendedor'::text` |
| `status` | `text` | YES | `'pending'::text` |
| `invited_by` | `uuid` | NO | `` |
| `expires_at` | `timestamp with time zone` | YES | `(now() + '7 days'::interval)` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |
| `invite_token` | `text` | YES | `` |

### Tabela: `tenants`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `name` | `text` | NO | `` |
| `descricao` | `text` | YES | `` |
| `slogan` | `text` | YES | `` |
| `logo_url` | `text` | YES | `` |
| `join_code` | `text` | YES | `` |
| `ativa` | `boolean` | YES | `true` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |
| `meta_leads_distribution_enabled` | `boolean` | YES | `false` |
| `meta_leads` | `integer` | YES | `100` |
| `meta_vendas` | `integer` | YES | `20` |

### Tabela: `user_achievements`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `user_id` | `uuid` | NO | `` |
| `tenant_id` | `uuid` | NO | `` |
| `achievement_id` | `uuid` | NO | `` |
| `current_progress` | `integer` | YES | `0` |
| `unlocked_at` | `timestamp with time zone` | YES | `` |
| `is_unlocked` | `boolean` | YES | `false` |
| `is_notified` | `boolean` | YES | `false` |
| `is_featured` | `boolean` | YES | `false` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `vendas`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `cliente_id` | `uuid` | YES | `` |
| `produto_id` | `uuid` | YES | `` |
| `valor` | `numeric` | NO | `` |
| `data_venda` | `timestamp with time zone` | YES | `now()` |
| `status` | `text` | YES | `'concluida'::text` |
| `notas` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `webhook_deliveries`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `subscription_id` | `uuid` | NO | `` |
| `event_id` | `uuid` | NO | `` |
| `status` | `text` | YES | `'pending'::text` |
| `response_status_code` | `integer` | YES | `` |
| `response_body` | `text` | YES | `` |
| `error_message` | `text` | YES | `` |
| `attempt_number` | `integer` | YES | `1` |
| `next_retry_at` | `timestamp with time zone` | YES | `` |
| `last_attempted_at` | `timestamp with time zone` | YES | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `webhook_events`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `event_type` | `text` | NO | `` |
| `entity_type` | `text` | NO | `` |
| `entity_id` | `uuid` | NO | `` |
| `payload` | `jsonb` | NO | `` |
| `created_at` | `timestamp with time zone` | YES | `now()` |

### Tabela: `webhook_logs`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `integration_id` | `uuid` | NO | `` |
| `event_type` | `character varying` | NO | `` |
| `payload` | `jsonb` | NO | `` |
| `processed` | `boolean` | YES | `false` |
| `error_message` | `text` | YES | `` |
| `created_at` | `timestamp with time zone` | NO | `now()` |
| `updated_at` | `timestamp with time zone` | NO | `now()` |

### Tabela: `webhook_subscriptions`
| Coluna | Tipo | Null? | Default |
|---|---|---|---|
| `id` | `uuid` | NO | `gen_random_uuid()` |
| `tenant_id` | `uuid` | NO | `` |
| `url` | `text` | NO | `` |
| `event_type` | `text` | NO | `` |
| `active` | `boolean` | YES | `true` |
| `secret` | `text` | YES | `` |
| `headers` | `jsonb` | YES | `'{}'::jsonb` |
| `retry_policy` | `jsonb` | YES | `'{"max_retries": 5, "backoff_multiplier": 2}'::jso` |
| `created_at` | `timestamp with time zone` | YES | `now()` |
| `updated_at` | `timestamp with time zone` | YES | `now()` |

### Relacionamentos (FKs)
- **profiles_default_tenant_id_fkey**: `profiles.default_tenant_id`  `tenants.id`
- **memberships_tenant_id_fkey**: `memberships.tenant_id`  `tenants.id`
- **team_invites_tenant_id_fkey**: `team_invites.tenant_id`  `tenants.id`
- **plans_tenant_id_fkey**: `plans.tenant_id`  `tenants.id`
- **subscriptions_tenant_id_fkey**: `subscriptions.tenant_id`  `tenants.id`
- **subscriptions_plan_id_fkey**: `subscriptions.plan_id`  `plans.id`
- **company_settings_tenant_id_fkey**: `company_settings.tenant_id`  `tenants.id`
- **equipes_tenant_id_fkey**: `equipes.tenant_id`  `tenants.id`
- **campanhas_tenant_id_fkey**: `campanhas.tenant_id`  `tenants.id`
- **lead_origins_tenant_id_fkey**: `lead_origins.tenant_id`  `tenants.id`
- **lead_loss_reasons_tenant_id_fkey**: `lead_loss_reasons.tenant_id`  `tenants.id`
- **pipeline_stages_tenant_id_fkey**: `pipeline_stages.tenant_id`  `tenants.id`
- **user_achievements_achievement_id_fkey**: `user_achievements.achievement_id`  `achievement_definitions.id`
- **clientes_tenant_id_fkey**: `clientes.tenant_id`  `tenants.id`
- **clientes_campanha_id_fkey**: `clientes.campanha_id`  `campanhas.id`
- **clientes_origem_id_fkey**: `clientes.origem_id`  `lead_origins.id`
- **clientes_motivo_perda_id_fkey**: `clientes.motivo_perda_id`  `lead_loss_reasons.id`
- **produtos_tenant_id_fkey**: `produtos.tenant_id`  `tenants.id`
- **produtos_equipe_tenant_id_fkey**: `produtos_equipe.tenant_id`  `tenants.id`
- **cliente_produtos_tenant_id_fkey**: `cliente_produtos.tenant_id`  `tenants.id`
- **cliente_produtos_cliente_id_fkey**: `cliente_produtos.cliente_id`  `clientes.id`
- **cliente_produtos_produto_id_fkey**: `cliente_produtos.produto_id`  `produtos.id`
- **lead_custom_fields_tenant_id_fkey**: `lead_custom_fields.tenant_id`  `tenants.id`
- **lead_custom_field_values_lead_id_fkey**: `lead_custom_field_values.lead_id`  `clientes.id`
- **lead_custom_field_values_custom_field_id_fkey**: `lead_custom_field_values.custom_field_id`  `lead_custom_fields.id`
- **product_custom_fields_tenant_id_fkey**: `product_custom_fields.tenant_id`  `tenants.id`
- **product_custom_field_values_produto_id_fkey**: `product_custom_field_values.produto_id`  `produtos.id`
- **product_custom_field_values_custom_field_id_fkey**: `product_custom_field_values.custom_field_id`  `product_custom_fields.id`
- **processes_tenant_id_fkey**: `processes.tenant_id`  `tenants.id`
- **tarefas_tenant_id_fkey**: `tarefas.tenant_id`  `tenants.id`
- **tarefas_cliente_id_fkey**: `tarefas.cliente_id`  `clientes.id`
- **tarefas_produto_id_fkey**: `tarefas.produto_id`  `produtos.id`
- **tarefas_equipe_id_fkey**: `tarefas.equipe_id`  `equipes.id`
- **tarefas_process_id_fkey**: `tarefas.process_id`  `processes.id`
- **tarefas_produtos_tarefa_id_fkey**: `tarefas_produtos.tarefa_id`  `tarefas.id`
- **tarefas_produtos_produto_id_fkey**: `tarefas_produtos.produto_id`  `produtos.id`
- **tarefa_checklist_tarefa_id_fkey**: `tarefa_checklist.tarefa_id`  `tarefas.id`
- **lead_tasks_tenant_id_fkey**: `lead_tasks.tenant_id`  `tenants.id`
- **lead_tasks_lead_id_fkey**: `lead_tasks.lead_id`  `clientes.id`
- **vendas_tenant_id_fkey**: `vendas.tenant_id`  `tenants.id`
- **vendas_cliente_id_fkey**: `vendas.cliente_id`  `clientes.id`
- **vendas_produto_id_fkey**: `vendas.produto_id`  `produtos.id`
- **despesas_tenant_id_fkey**: `despesas.tenant_id`  `tenants.id`
- **contacts_tenant_id_fkey**: `contacts.tenant_id`  `tenants.id`
- **atividades_tenant_id_fkey**: `atividades.tenant_id`  `tenants.id`
- **atividades_cliente_id_fkey**: `atividades.cliente_id`  `clientes.id`
- **lead_timeline_tenant_id_fkey**: `lead_timeline.tenant_id`  `tenants.id`
- **lead_timeline_lead_id_fkey**: `lead_timeline.lead_id`  `clientes.id`
- **lead_attachments_tenant_id_fkey**: `lead_attachments.tenant_id`  `tenants.id`
- **lead_attachments_lead_id_fkey**: `lead_attachments.lead_id`  `clientes.id`
- **automacoes_tenant_id_fkey**: `automacoes.tenant_id`  `tenants.id`
- **automacao_logs_automacao_id_fkey**: `automacao_logs.automacao_id`  `automacoes.id`
- **webhook_subscriptions_tenant_id_fkey**: `webhook_subscriptions.tenant_id`  `tenants.id`
- **webhook_events_tenant_id_fkey**: `webhook_events.tenant_id`  `tenants.id`
- **webhook_deliveries_subscription_id_fkey**: `webhook_deliveries.subscription_id`  `webhook_subscriptions.id`
- **webhook_deliveries_event_id_fkey**: `webhook_deliveries.event_id`  `webhook_events.id`
- **api_keys_tenant_id_fkey**: `api_keys.tenant_id`  `tenants.id`
- **audit_logs_tenant_id_fkey**: `audit_logs.tenant_id`  `tenants.id`
- **webhook_logs_tenant_id_fkey**: `webhook_logs.tenant_id`  `tenants.id`
- **tarefa_anexos_tenant_id_fkey**: `tarefa_anexos.tenant_id`  `tenants.id`
- **tarefa_anexos_tarefa_id_fkey**: `tarefa_anexos.tarefa_id`  `tarefas.id`
- **task_stages_tenant_id_fkey**: `task_stages.tenant_id`  `tenants.id`
- **sales_playbook_objections_team_id_fkey**: `sales_playbook_objections.team_id`  `tenants.id`
- **gamification_stats_tenant_id_fkey**: `gamification_stats.tenant_id`  `tenants.id`
- **integrations_tenant_id_fkey**: `integrations.tenant_id`  `tenants.id`
- **conversations_tenant_id_fkey**: `conversations.tenant_id`  `tenants.id`
- **conversations_contact_id_fkey**: `conversations.contact_id`  `clientes.id`
- **messages_conversation_id_fkey**: `messages.conversation_id`  `conversations.id`
- **messages_replied_to_message_id_fkey**: `messages.replied_to_message_id`  `messages.id`
- **achievement_definitions_tenant_id_fkey**: `achievement_definitions.tenant_id`  `tenants.id`
- **user_achievements_tenant_id_fkey**: `user_achievements.tenant_id`  `tenants.id`

### Polticas de Segurana (RLS)
- **System can insert gamification stats** na tabela `gamification_stats`
  - Ao: `INSERT`
  - Roles: `0`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true))))`

- **Users can update own gamification stats** na tabela `gamification_stats`
  - Ao: `UPDATE`
  - Roles: `0`
  - Using: `(user_id = auth.uid())`
  - Check: `N/A`

- **Users can view team gamification stats** na tabela `gamification_stats`
  - Ao: `SELECT`
  - Roles: `0`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true))))`
  - Check: `N/A`

- **pipeline_stages_delete_own_tenant** na tabela `pipeline_stages`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `N/A`

- **pipeline_stages_insert_own_tenant** na tabela `pipeline_stages`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`

- **pipeline_stages_select_own_tenant** na tabela `pipeline_stages`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `N/A`

- **pipeline_stages_update_own_tenant** na tabela `pipeline_stages`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`

- **Service role can insert webhook logs** na tabela `webhook_logs`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(( SELECT auth.role() AS role) = 'service_role'::text)`

- **Users can view their tenant webhook logs** na tabela `webhook_logs`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text])) AND (memberships.active = true))))`
  - Check: `N/A`

- **Membros podem ver conquistas do prprio tenant** na tabela `user_achievements`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true))))`
  - Check: `N/A`

- **Sistema pode inserir/atualizar conquistas** na tabela `user_achievements`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true))))`

- **Usurios podem atualizar suas prprias conquistas** na tabela `user_achievements`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(user_id = auth.uid())`
  - Check: `(user_id = auth.uid())`

- **Membros podem ver conquistas do tenant ou globais** na tabela `achievement_definitions`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `((tenant_id IS NULL) OR (tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true)))))`
  - Check: `N/A`

- **Users can delete their tenant's api keys** na tabela `api_keys`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`
  - Check: `N/A`

- **Users can insert their tenant's api keys** na tabela `api_keys`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`

- **Users can update their tenant's api keys** na tabela `api_keys`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`
  - Check: `N/A`

- **Users can view their tenant's api keys** na tabela `api_keys`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`
  - Check: `N/A`

- **Membros podem inserir leads no tenant** na tabela `clientes`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true))))`

- **Membros veem leads do tenant** na tabela `clientes`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `N/A`

- **clientes_update_own_tenant** na tabela `clientes`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true))))`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true))))`

- **Users can view memberships** na tabela `memberships`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `can_view_membership(user_id, tenant_id)`
  - Check: `N/A`

- **Users can delete expenses from their tenant** na tabela `despesas`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT despesas.tenant_id
   FROM profiles
  WHERE (profiles.id = auth.uid())))`
  - Check: `N/A`

- **Users can insert expenses to their tenant** na tabela `despesas`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT despesas.tenant_id
   FROM profiles
  WHERE (profiles.id = auth.uid())))`

- **Users can update expenses from their tenant** na tabela `despesas`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT despesas.tenant_id
   FROM profiles
  WHERE (profiles.id = auth.uid())))`
  - Check: `(tenant_id IN ( SELECT despesas.tenant_id
   FROM profiles
  WHERE (profiles.id = auth.uid())))`

- **Users can view expenses from their tenant** na tabela `despesas`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT despesas.tenant_id
   FROM profiles
  WHERE (profiles.id = auth.uid())))`
  - Check: `N/A`

- **Users can view their own profile** na tabela `profiles`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(id = ( SELECT auth.uid() AS uid))`
  - Check: `N/A`

- **Users can insert automacao logs for their tenant** na tabela `automacao_logs`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(automacao_id IN ( SELECT automacoes.id
   FROM automacoes
  WHERE (automacoes.tenant_id IN ( SELECT memberships.tenant_id
           FROM memberships
          WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))))`

- **Users can view automacao logs from their tenant** na tabela `automacao_logs`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(automacao_id IN ( SELECT automacoes.id
   FROM automacoes
  WHERE (automacoes.tenant_id IN ( SELECT memberships.tenant_id
           FROM memberships
          WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))))`
  - Check: `N/A`

- **tarefa_checklist_insert_policy** na tabela `tarefa_checklist`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(EXISTS ( SELECT 1
   FROM (tarefas t
     JOIN memberships m ON ((m.tenant_id = t.tenant_id)))
  WHERE ((t.id = tarefa_checklist.tarefa_id) AND (m.user_id = auth.uid()))))`

- **tarefa_checklist_select_policy** na tabela `tarefa_checklist`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(EXISTS ( SELECT 1
   FROM (tarefas t
     JOIN memberships m ON ((m.tenant_id = t.tenant_id)))
  WHERE ((t.id = tarefa_checklist.tarefa_id) AND (m.user_id = auth.uid()))))`
  - Check: `N/A`

- **Membros podem atualizar valores de campos personalizados** na tabela `lead_custom_field_values`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(lead_id IN ( SELECT c.id
   FROM (clientes c
     JOIN memberships m ON ((m.tenant_id = c.tenant_id)))
  WHERE ((m.user_id = auth.uid()) AND (m.active = true))))`
  - Check: `(lead_id IN ( SELECT c.id
   FROM (clientes c
     JOIN memberships m ON ((m.tenant_id = c.tenant_id)))
  WHERE ((m.user_id = auth.uid()) AND (m.active = true))))`

- **Membros podem deletar valores de campos personalizados** na tabela `lead_custom_field_values`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `(lead_id IN ( SELECT c.id
   FROM (clientes c
     JOIN memberships m ON ((m.tenant_id = c.tenant_id)))
  WHERE ((m.user_id = auth.uid()) AND (m.active = true))))`
  - Check: `N/A`

- **Membros podem inserir valores de campos personalizados** na tabela `lead_custom_field_values`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(lead_id IN ( SELECT c.id
   FROM (clientes c
     JOIN memberships m ON ((m.tenant_id = c.tenant_id)))
  WHERE ((m.user_id = auth.uid()) AND (m.active = true))))`

- **Membros podem ver valores de campos personalizados** na tabela `lead_custom_field_values`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(lead_id IN ( SELECT c.id
   FROM (clientes c
     JOIN memberships m ON ((m.tenant_id = c.tenant_id)))
  WHERE ((m.user_id = auth.uid()) AND (m.active = true))))`
  - Check: `N/A`

- **Owner can delete their tenant** na tabela `tenants`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `(id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.role = 'owner'::text) AND (memberships.active = true))))`
  - Check: `N/A`

- **Owners e admins podem atualizar tenants** na tabela `tenants`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`
  - Check: `(id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`

- **Users can view tenants they are members of** na tabela `tenants`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `N/A`

- **Membros veem produtos do tenant** na tabela `produtos`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `N/A`

- **Owners e admins podem atualizar produtos** na tabela `produtos`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`

- **Owners e admins podem deletar produtos** na tabela `produtos`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`
  - Check: `N/A`

- **Owners e admins podem inserir produtos** na tabela `produtos`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = auth.uid()) AND (memberships.active = true) AND (memberships.role = ANY (ARRAY['owner'::text, 'admin'::text, 'administrador'::text])))))`

- **task_stages_delete_own_tenant** na tabela `task_stages`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `N/A`

- **task_stages_insert_own_tenant** na tabela `task_stages`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`

- **task_stages_select_own_tenant** na tabela `task_stages`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `N/A`

- **task_stages_update_own_tenant** na tabela `task_stages`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`
  - Check: `(tenant_id IN ( SELECT memberships.tenant_id
   FROM memberships
  WHERE ((memberships.user_id = ( SELECT auth.uid() AS uid)) AND (memberships.active = true))))`

- **Playbook: allow reading defaults and own teams** na tabela `sales_playbook_objections`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(is_default OR (user_id = ( SELECT auth.uid() AS uid)) OR ((team_id IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM memberships m
  WHERE ((m.user_id = ( SELECT auth.uid() AS uid)) AND (m.tenant_id = sales_playbook_objections.team_id) AND (m.active = true))))))`
  - Check: `N/A`

- **Playbook: delete own cards** na tabela `sales_playbook_objections`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)) AND (is_default = false))`
  - Check: `N/A`

- **Playbook: insert owned row** na tabela `sales_playbook_objections`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)) AND ((team_id IS NULL) OR (EXISTS ( SELECT 1
   FROM memberships m
  WHERE ((m.user_id = ( SELECT auth.uid() AS uid)) AND (m.tenant_id = sales_playbook_objections.team_id) AND (m.active = true))))))`

- **Playbook: update own cards** na tabela `sales_playbook_objections`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)) AND (is_default = false))`
  - Check: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)) AND (is_default = false))`

- **Proposals: owners can delete** na tabela `proposals`
  - Ao: `DELETE`
  - Roles: `16481`
  - Using: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)))`
  - Check: `N/A`

- **Proposals: owners can insert** na tabela `proposals`
  - Ao: `INSERT`
  - Roles: `16481`
  - Using: `N/A`
  - Check: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)))`

- **Proposals: owners can read** na tabela `proposals`
  - Ao: `SELECT`
  - Roles: `16481`
  - Using: `(user_id = ( SELECT auth.uid() AS uid))`
  - Check: `N/A`

- **Proposals: owners can update status** na tabela `proposals`
  - Ao: `UPDATE`
  - Roles: `16481`
  - Using: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)))`
  - Check: `((( SELECT auth.uid() AS uid) IS NOT NULL) AND (user_id = ( SELECT auth.uid() AS uid)))` |
